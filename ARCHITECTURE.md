# Text Alignment Library - Architecture

## ğŸ“ System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Application Layer                            â”‚
â”‚  (Ionic Angular App - memorization-detail.page.ts)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ Uses
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Presentation Layer                              â”‚
â”‚           (TextAlignmentViewerComponent - Ionic)                     â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  Metrics    â”‚  â”‚ Token Grid   â”‚  â”‚ Text Comparison     â”‚        â”‚
â”‚  â”‚  Display    â”‚  â”‚ Visualizationâ”‚  â”‚ Side-by-Side        â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ Uses
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Business Logic Layer                              â”‚
â”‚              (TextAligner - Framework Agnostic)                      â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                      TextAligner                              â”‚  â”‚
â”‚  â”‚                   (Main API Facade)                           â”‚  â”‚
â”‚  â”‚                                                               â”‚  â”‚
â”‚  â”‚  â€¢ compare(ref, hyp) â†’ AlignmentResult                       â”‚  â”‚
â”‚  â”‚  â€¢ align(ref, hyp) â†’ AlignedToken[]                          â”‚  â”‚
â”‚  â”‚  â€¢ calculateMetrics(alignment) â†’ WERMetrics                  â”‚  â”‚
â”‚  â”‚  â€¢ generateDiff(alignment, options) â†’ string                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                             â”‚                                         â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚              â”‚              â”‚              â”‚                         â”‚
â”‚              â–¼              â–¼              â–¼                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ AlignmentEngineâ”‚ â”‚  Metrics    â”‚ â”‚     Diff     â”‚               â”‚
â”‚  â”‚                â”‚ â”‚ Calculator  â”‚ â”‚  Generator   â”‚               â”‚
â”‚  â”‚ â€¢ align()      â”‚ â”‚             â”‚ â”‚              â”‚               â”‚
â”‚  â”‚ â€¢ tokenize()   â”‚ â”‚ â€¢ calcWER() â”‚ â”‚ â€¢ generate() â”‚               â”‚
â”‚  â”‚ â€¢ normalize()  â”‚ â”‚ â€¢ calcCER() â”‚ â”‚ â€¢ formats    â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ Uses
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Algorithm Layer                                 â”‚
â”‚            (Wagner-Fischer / Levenshtein Distance)                   â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  1. Build Edit Distance Matrix (O(mÃ—n))                       â”‚  â”‚
â”‚  â”‚     â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”                                     â”‚  â”‚
â”‚  â”‚     â”‚ 0 â”‚ 1 â”‚ 2 â”‚ 3 â”‚ 4 â”‚                                     â”‚  â”‚
â”‚  â”‚     â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤                                     â”‚  â”‚
â”‚  â”‚     â”‚ 1 â”‚ X â”‚ X â”‚ X â”‚ X â”‚                                     â”‚  â”‚
â”‚  â”‚     â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤                                     â”‚  â”‚
â”‚  â”‚     â”‚ 2 â”‚ X â”‚ X â”‚ X â”‚ X â”‚                                     â”‚  â”‚
â”‚  â”‚     â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜                                     â”‚  â”‚
â”‚  â”‚                                                               â”‚  â”‚
â”‚  â”‚  2. Backtrack for Optimal Path                               â”‚  â”‚
â”‚  â”‚     Match: diagonal (cost 0)                                 â”‚  â”‚
â”‚  â”‚     Substitute: diagonal (cost 1)                            â”‚  â”‚
â”‚  â”‚     Delete: up (cost 1)                                      â”‚  â”‚
â”‚  â”‚     Insert: left (cost 1)                                    â”‚  â”‚
â”‚  â”‚                                                               â”‚  â”‚
â”‚  â”‚  3. Generate Alignment                                       â”‚  â”‚
â”‚  â”‚     [MATCH, SUBSTITUTION, DELETION, INSERTION]               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ Produces
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Data Layer                                   â”‚
â”‚                    (Types & Interfaces)                              â”‚
â”‚                                                                       â”‚
â”‚  AlignmentResult {                                                   â”‚
â”‚    alignment: AlignedToken[]                                         â”‚
â”‚    metrics: WERMetrics                                               â”‚
â”‚    diffString: string                                                â”‚
â”‚    reference: string                                                 â”‚
â”‚    hypothesis: string                                                â”‚
â”‚  }                                                                   â”‚
â”‚                                                                       â”‚
â”‚  WERMetrics {                                                        â”‚
â”‚    wer: number                                                       â”‚
â”‚    accuracy: number                                                  â”‚
â”‚    substitutions: number                                             â”‚
â”‚    deletions: number                                                 â”‚
â”‚    insertions: number                                                â”‚
â”‚    matches: number                                                   â”‚
â”‚  }                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Data Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   User      â”‚
â”‚   Speaks    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Speech Recognition  â”‚
â”‚  Service (Browser)   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼ (transcript)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Memorization Detail Page â”‚
â”‚  â€¢ referenceText         â”‚
â”‚  â€¢ hypothesisText        â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼ User clicks "Show Detailed Analysis"
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TextAlignmentViewerComponent â”‚
â”‚  [referenceText]             â”‚
â”‚  [hypothesisText]            â”‚
â”‚  [normalizer]                â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼ ngOnChanges()
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   TextAligner        â”‚
â”‚   .compare()         â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â”€â–º AlignmentEngine.align()
       â”‚    â”œâ”€â–º tokenize()
       â”‚    â”œâ”€â–º normalize()
       â”‚    â”œâ”€â–º computeEditDistance()
       â”‚    â””â”€â–º backtrack()
       â”‚         â”‚
       â”‚         â–¼ AlignedToken[]
       â”‚
       â”œâ”€â”€â–º MetricsCalculator.calculateWER()
       â”‚         â”‚
       â”‚         â–¼ WERMetrics
       â”‚
       â””â”€â”€â–º DiffGenerator.generate()
                 â”‚
                 â–¼ string (diff)
       
       â–¼ AlignmentResult
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Component Renders:           â”‚
â”‚  â€¢ Metrics badges            â”‚
â”‚  â€¢ Token grid                â”‚
â”‚  â€¢ Text comparison           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User Sees   â”‚
â”‚  Results     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—ï¸ Class Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           <<interface>>                 â”‚
â”‚         AlignmentOptions                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + caseSensitive?: boolean               â”‚
â”‚ + tokenizer?: (text) => string[]        â”‚
â”‚ + normalizer?: (token) => string        â”‚
â”‚ + includeConfidence?: boolean           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â–³
                    â”‚ uses
                    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          AlignmentEngine                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ - options: AlignmentOptions             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + align(ref, hyp): AlignedToken[]       â”‚
â”‚ - processText(text): string[]           â”‚
â”‚ - computeEditDistance(): Matrix         â”‚
â”‚ - backtrack(): AlignedToken[]           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         MetricsCalculator               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + calculateWER(): WERMetrics            â”‚
â”‚ + calculateCER(): number                â”‚
â”‚ + getDetailedStats(): Stats             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           <<interface>>                 â”‚
â”‚            DiffOptions                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + useColors?: boolean                   â”‚
â”‚ + useHtml?: boolean                     â”‚
â”‚ + showLineNumbers?: boolean             â”‚
â”‚ + format?: 'inline' | ...               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â–³
                    â”‚ uses
                    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           DiffGenerator                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ - options: DiffOptions                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + generate(): string                    â”‚
â”‚ - generateInlineDiff(): string          â”‚
â”‚ - generateSideBySideDiff(): string      â”‚
â”‚ - generateUnifiedDiff(): string         â”‚
â”‚ + generateSummary(): string             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           TextAligner                   â”‚
â”‚         (Facade Pattern)                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ - engine: AlignmentEngine               â”‚â—„â”€â”€â”€â”
â”‚ - metricsCalc: MetricsCalculator        â”‚â—„â”€â”€â”€â”¤
â”‚ - diffGen: DiffGenerator                â”‚â—„â”€â”€â”€â”¤
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚ + compare(): AlignmentResult            â”‚    â”‚
â”‚ + align(): AlignedToken[]               â”‚â”€â”€â”€â”€â”¤
â”‚ + calculateMetrics(): WERMetrics        â”‚â”€â”€â”€â”€â”¤
â”‚ + generateDiff(): string                â”‚â”€â”€â”€â”€â”¤
â”‚ + getDetailedStats(): Stats             â”‚â”€â”€â”€â”€â”˜
â”‚ + calculateCER(): number                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           <<enum>>                      â”‚
â”‚       AlignmentOperation                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ MATCH                                   â”‚
â”‚ SUBSTITUTION                            â”‚
â”‚ DELETION                                â”‚
â”‚ INSERTION                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         AlignedToken                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + reference: string | null              â”‚
â”‚ + hypothesis: string | null             â”‚
â”‚ + operation: AlignmentOperation         â”‚
â”‚ + referenceIndex: number | null         â”‚
â”‚ + hypothesisIndex: number | null        â”‚
â”‚ + confidence?: number                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           WERMetrics                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + wer: number                           â”‚
â”‚ + accuracy: number                      â”‚
â”‚ + substitutions: number                 â”‚
â”‚ + deletions: number                     â”‚
â”‚ + insertions: number                    â”‚
â”‚ + matches: number                       â”‚
â”‚ + totalReferenceWords: number           â”‚
â”‚ + totalHypothesisWords: number          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        AlignmentResult                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + alignment: AlignedToken[]             â”‚
â”‚ + metrics: WERMetrics                   â”‚
â”‚ + diffString: string                    â”‚
â”‚ + reference: string                     â”‚
â”‚ + hypothesis: string                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”€ Sequence Diagram

```
User          Component         TextAligner    Engine    Metrics    DiffGen
 â”‚                â”‚                  â”‚            â”‚         â”‚          â”‚
 â”‚   speak        â”‚                  â”‚            â”‚         â”‚          â”‚
 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                  â”‚            â”‚         â”‚          â”‚
 â”‚                â”‚                  â”‚            â”‚         â”‚          â”‚
 â”‚   click        â”‚                  â”‚            â”‚         â”‚          â”‚
 â”‚   "Analyze"    â”‚                  â”‚            â”‚         â”‚          â”‚
 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                  â”‚            â”‚         â”‚          â”‚
 â”‚                â”‚                  â”‚            â”‚         â”‚          â”‚
 â”‚                â”‚  compare()       â”‚            â”‚         â”‚          â”‚
 â”‚                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚            â”‚         â”‚          â”‚
 â”‚                â”‚                  â”‚            â”‚         â”‚          â”‚
 â”‚                â”‚                  â”‚  align()   â”‚         â”‚          â”‚
 â”‚                â”‚                  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚         â”‚          â”‚
 â”‚                â”‚                  â”‚            â”‚         â”‚          â”‚
 â”‚                â”‚                  â”‚ AlignedToken[]       â”‚          â”‚
 â”‚                â”‚                  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”‚          â”‚
 â”‚                â”‚                  â”‚            â”‚         â”‚          â”‚
 â”‚                â”‚                  â”‚ calculateWER()       â”‚          â”‚
 â”‚                â”‚                  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚          â”‚
 â”‚                â”‚                  â”‚            â”‚         â”‚          â”‚
 â”‚                â”‚                  â”‚       WERMetrics     â”‚          â”‚
 â”‚                â”‚                  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”‚
 â”‚                â”‚                  â”‚            â”‚         â”‚          â”‚
 â”‚                â”‚                  â”‚ generate() â”‚         â”‚          â”‚
 â”‚                â”‚                  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
 â”‚                â”‚                  â”‚            â”‚         â”‚          â”‚
 â”‚                â”‚                  â”‚              diff string        â”‚
 â”‚                â”‚                  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
 â”‚                â”‚                  â”‚            â”‚         â”‚          â”‚
 â”‚                â”‚ AlignmentResult  â”‚            â”‚         â”‚          â”‚
 â”‚                â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤            â”‚         â”‚          â”‚
 â”‚                â”‚                  â”‚            â”‚         â”‚          â”‚
 â”‚                â”‚  render()        â”‚            â”‚         â”‚          â”‚
 â”‚   display      â”‚                  â”‚            â”‚         â”‚          â”‚
 â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                  â”‚            â”‚         â”‚          â”‚
 â”‚                â”‚                  â”‚            â”‚         â”‚          â”‚
```

---

## ğŸ§© Design Patterns Used

### 1. **Facade Pattern**
- `TextAligner` provides a simple interface to complex subsystems
- Hides complexity of Engine, Metrics, and DiffGenerator

### 2. **Strategy Pattern**
- Custom tokenizers and normalizers can be injected
- Different diff formats (inline, side-by-side, unified)

### 3. **Builder Pattern**
- `AlignmentOptions` for configuring alignment behavior
- `DiffOptions` for configuring diff generation

### 4. **Component Pattern**
- `TextAlignmentViewerComponent` encapsulates UI logic
- Clear input/output boundaries

### 5. **Separation of Concerns**
- Algorithm layer (edit distance)
- Business logic layer (metrics, diffs)
- Presentation layer (component)

---

## ğŸ“¦ Module Dependencies

```
TextAlignmentViewerComponent (Angular/Ionic)
    â”‚
    â”œâ”€â–º CommonModule (Angular)
    â”œâ”€â–º IonicModule (Ionic)
    â”‚
    â””â”€â–º TextAligner (Framework-agnostic)
            â”‚
            â”œâ”€â–º AlignmentEngine
            â”‚       â””â”€â–º types
            â”‚
            â”œâ”€â–º MetricsCalculator
            â”‚       â””â”€â–º types
            â”‚
            â””â”€â–º DiffGenerator
                    â””â”€â–º types

âœ… Zero external dependencies in core library
âœ… Only Angular/Ionic in component layer
```

---

## ğŸ¯ SOLID Principles Applied

### Single Responsibility
- âœ… `AlignmentEngine`: Only handles alignment
- âœ… `MetricsCalculator`: Only calculates metrics
- âœ… `DiffGenerator`: Only generates diffs

### Open/Closed
- âœ… Open for extension (custom tokenizers/normalizers)
- âœ… Closed for modification (core algorithm unchanged)

### Liskov Substitution
- âœ… Custom tokenizers/normalizers are interchangeable
- âœ… Diff generators follow same interface

### Interface Segregation
- âœ… Separate interfaces for options, results, tokens
- âœ… Clients depend only on what they use

### Dependency Inversion
- âœ… Depends on abstractions (interfaces)
- âœ… Not on concrete implementations

---

## ğŸ” Type Safety

```typescript
// Strong typing throughout
AlignmentOptions      â†’ TextAligner
string, string        â†’ compare()
AlignmentResult       â†’ returned
AlignedToken[]        â†’ alignment
WERMetrics           â†’ metrics
string               â†’ diffString

// Compile-time safety
enum AlignmentOperation  // No magic strings
interface AlignedToken   // Structured data
interface WERMetrics     // Type-safe metrics
```

---

## âš¡ Performance Optimization

### Algorithm Level
- Dynamic programming (avoid recomputation)
- Single-pass matrix fill
- Efficient backtracking

### Data Level
- Minimal object creation
- Pre-allocated arrays
- Efficient string operations

### UI Level
- OnPush change detection (possible)
- Virtual scrolling (for large alignments)
- Lazy rendering

---

## ğŸ§ª Testability

### Pure Functions
- âœ… No side effects
- âœ… Deterministic output
- âœ… Easy to unit test

### Dependency Injection
- âœ… Custom tokenizers/normalizers
- âœ… Mockable components

### Separation of Concerns
- âœ… Algorithm isolated from UI
- âœ… Metrics isolated from alignment
- âœ… Each layer testable independently

---

Built with best practices, SOLID principles, and scalability in mind! ğŸš€

